# Plan 04-01: Returns API

## Context

Phase 4 exposes REST endpoints for eBay returns management.
Builds on Phase 3 (EbayReturnService, EbayReturnSyncService, EbayReturnRepository).

**Patterns from existing API** (api/ebay/orders.py):
- FastAPI router with endpoint grouping
- Pydantic schemas for request/response
- `get_user_db` dependency for auth
- Service layer orchestration
- Proper error handling and logging

## Tasks

### Task 1: Create Pydantic Schemas

**Goal**: Create request/response schemas for returns API.

**Files to create**:
- `backend/schemas/ebay_return_schemas.py`

**Schemas**:
```python
# Requests
class SyncReturnsRequest
class AcceptReturnRequest
class DeclineReturnRequest
class IssueRefundRequest
class MarkAsReceivedRequest
class SendMessageRequest

# Responses
class EbayReturnResponse
class ReturnListResponse
class SyncReturnsResponse
class ReturnActionResponse
class ReturnStatisticsResponse
```

### Task 2: Create Returns API Router

**Goal**: Create FastAPI router with returns endpoints.

**Files to create**:
- `backend/api/ebay/returns.py`

**Endpoints**:
```
POST   /returns/sync            - Sync returns from eBay
GET    /returns                 - List returns with pagination
GET    /returns/statistics      - Get return statistics
GET    /returns/needs-action    - List returns needing action
GET    /returns/past-deadline   - List returns past deadline
GET    /returns/{return_id}     - Get return details
POST   /returns/{return_id}/accept    - Accept return
POST   /returns/{return_id}/decline   - Decline return
POST   /returns/{return_id}/refund    - Issue refund
POST   /returns/{return_id}/received  - Mark as received
POST   /returns/{return_id}/message   - Send message
```

### Task 3: Register Router

**Goal**: Register returns router in api/ebay/__init__.py.

**Files to modify**:
- `backend/api/ebay/__init__.py`

---

## Execution Order

1. **Task 1**: Create Pydantic schemas
2. **Task 2**: Create returns API router
3. **Task 3**: Register router

---

*Plan created: 2026-01-13*
